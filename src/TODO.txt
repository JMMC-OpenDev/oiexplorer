
performance :
- avoid repeated cast
- replace array.length in loops : matches '.length; i++'